[TOC]
# <center> 第二章 数据的机器级表示

## 一、 数值数据的表示

### 1. 进位计数制
用一个下标表示数的基（ radix / base）
或用后缀B-二进制（H-十六进制（前缀0x-）、O-八进制） 
$11001_2 = 25_{10}、11001B= 25$

**<mark> i. 二、八、十六进制数的相互转换**
- 八进制数转换成二进制数
$(13.724)_8=(  001\quad 011\quad .\quad 111\quad  010\quad  100  )_2=(1011.1110101)_2$
- 十六进制数转换成二进制数
$(2B.5E)_{16} = (00101011\quad . \quad 01011110)_2 = (101011.0101111)_2  $
- 二进制数转换成八进制数  
$(0.10101)_2 = (  000\quad . \quad101\quad  010  )_2 = ( 0.52)_8 $ 
- 二进制数转换成十六进制数
$(11001.11)_2 = (  0001\quad  1001\quad . \quad 1100  )_2 = ( 19.C )_{16}$

**<mark> ii. R进制数 => 十进制数**
按“权”展开 (a power of R)
$$(10101.01)_2=1\times 2^4+1\times  2^2+1\times 2^0+1\times 2^{-2}=(21.25)_{10} \\
(307.6)_8=3\times 8^2+7\times 8^0+6\times 8^{-1}=(199.75)_{10} \\
(3A. 1)_{16}=3\times 16^1+10\times 16^0+1\times 16^{-1}=(58.0625)_{10}$$

**<mark> iii. 十进制数 => R进制数**
    整数部分和小数部分分别转换
① 整数(integral part)----“除基取余，上右下左”
② 小数(fractional part)----“乘基取整，上左下右”
<p align="center">
<img src="photos\2.1.1.3 进制转换.png" width="70%" height="100%">
</p>

---

### 2. 如何用二进制编码（正负号）
原码表示
<p align="center">
<img src="photos\2.1.2 原码.png" width="50%" height="100%">
</p>

**i. 补码 : 实现 + 与 - 的统一**
补码的定义    假定补码有n位，则：
定点整数：$[X]_补 = 2^n + X （-2^n ≤ X ＜ 2^n ，mod 2^n）$

eg. $ -3 \equiv 9 (mod 12) $
结论1：一个负数的补码等于模减该负数的绝对值。
结论2：对于某一确定的模，数x减去小于模的数y，总可以用数x加上-y的补码来代替。
```
9828 - 1928 = 9828 + (10e4 - 1928)
          = 9828+8072
          = 10e4 + 7900  
          = 7900（mod 10e4）
```

```
0111 1111 - 0100 0000 = 0111 1111 + (2^8- 0100 0000)
                      = 0111 1111 + 1100 0000 
                      = 1 0011 1111 (mod 2^8)
                      = 0011 1111   
```
<mark>结论1： 一个负数的补码等于对应正数补码的“各位取反、末位加1”
```
1 = 0001
1 - 2 = 0001 + (1 0000 - 0010) 
      = 0001 + 1110
      = 1111
  - 1 = 1111
```
<p align="center">
<img src="photos\2.1.2.1 补码.png" width="50%" height="100%">
</p>

**求真值？**
先看第一位（符号位）判断正负，整数其余位正常用，负数取反+1再算

**ii. 移码**
<p align="center">
<img src="photos\2.1.2.2 移码.png" width="60%" height="100%">
</p>

**iii. 无符号数**
<p align="center">
<img src = "photos\2.1.2.3 无符号整数.png" width = 60% height = 100%>
</p>
<mark>MIPS规定：无符号数运算溢出时，不产生“溢出异常”


**iv. 有符号整数**
<p align="center">
<img src = "photos\2.1.2.4 有符号整数.png" width = 60% height = 100%>
</p>

### 3. 浮点数表示（小数点的表示）
**浮点数表示范围**
<p align="center">
<img src = "photos\2.1.3 浮点数构成.png" width = 60% height = 100%>
</p>

**浮点数的构成**
<p align="center">
<img src = "photos\2.1.3 浮点数的表示.png" width = 60% height = 100%>
</p>

### 4. IEEE 754 Floating Point Standard
前置知识:规格化数与非规格化数
若浮点数的基数为2，则尾数规格化的浮点数的形式应为
$\pm 0.1bbbbbbb...b \times 2^E$
<mark>尾数部分的真值要大于或等于 $1/R， R$ 为 基数</mark>
<p align="center">
<img src = "photos\2.1.4 浮点数.png" width = 60% height = 100%>
</p>
<p align="center">
  <strong>浮点数</strong>
</p>

<p align="center">
<img src = "photos\2.1.4 特殊.png" width = 60% height = 100%>
</p>
<p align="center">
  <strong>特殊情况</strong>
</p>

<mark>二进制浮点数向十进制转换</mark>
eg.
```
1  0111 1101  110 0000 0000 0000 0000 0000
```
$(-1)^S \times (1 + Significand) \times 2^{(Exponent-127)}$

Exponent:
    • $0111 1101_{two} = 125_{ten}$
    • $Bias adjustment: 125 - 127 = -2$
Significand:
$$        
    1 + 1 \times  2 ^{- 1}+ 1 \times  2 ^{- 2} + 0 \times  2^{-3} + 0 \times  2^{-4}   + 0 \times  2^{-5} +...\\        
    = 1 + 2 ^{- 1} + 2 ^{- 2} = 1 + 0.5 + 0.25 = 1.75
$$
Represents: $-1.75_{ten} \times 2^{-2} = - 0.4375$

<mark>十进制浮点数向二进制转换</mark>

eg. -12.75 
转换整数部分:
$           12 = 8 + 4 = 1100_2$
转换小数部分:
$           .75 = .5 + .25 = .11_2$
整合并规格化:
$           1100.11 = 1.10011 \times 2^3$
转换指数: 
$127 + 3 = 128 + 2 = 1000 \quad0010_2$
答案:
$1 \qquad  1000 \quad 0010 \qquad 100\quad 1100\quad 0000\quad 0000 \quad 0000\quad 0000$

**异常**
<p align="center">
<img src = "photos\2.1.4 异常1.png" width = 60% height = 100%>
<img src = "photos\2.1.4 异常2.png" width = 60% height = 100%>
</p>

**<mark>关于 IEEE 754 的问题**

- **可表示的数值范围是什么？**

  单精度浮点数的最大值：约  $3.4 \times 10^{38}$  
  双精度浮点数的最大值：约  $1.8 \times 10^{308}$

- **类型转换的正确性**

  将整数转为浮点数再转回整数，对于双精度浮点数，结果正确；但转为单精度时不一定正确。  
  将浮点数转为整数再转回浮点数，无论是单精度还是双精度，结果都不一定正确。

- **浮点数加法结合律**

  浮点数加法不满足结合律。例如：  
   $x = -1.5 \times 10^{38}$， $y = 1.5 \times 10^{38}$， $z = 1.0$  
   $(x + y) + z = 1.0$，而  $x + (y + z) = 0.0$


### 5. 十进制数的表示(decimal)
1. **ASCII码**
**前分隔数字串**
符号位单独用一个字节表示，位于数字串之前。
正号用“+”的ASCII码(2BH)表示；负号用“-”的ASCII码(2DH)表示
例：十进制数+236表示为: 2B 32 33 36H
           0010 1011 0011 0010 0011 0011 0011 0110B
          十进制数-2369表示为: 2D 32 33 36 39H
           0010 1101 0011 0010 0011 0011 0011 0110 0011 1001B
**后嵌入数字串**
符号位嵌入最低位数字的ASCII码高4位中。比前分隔方式省一个字节。
正数不变；负数高4位变为0111.
例：十进制数+236表示为: 32 33 36H
           0011 0010 0011 0011 0011 0110B
          十进制数-2369表示为: 32 33 36 79H
           0011 0010 0011 0011 0011 0110 0111 1001B
缺点：占空间大，且需转换成二进制数或BCD码才能计算。

2. **BCD码**
编码思想:  每个十进数位至少有4位二进制表示。而4位二进制位可组合成16种状态，去掉10种状态后还有6种冗余状态。
编码方案
1． 十进制有权码
每个十进制数位的4个二进制位（称为基2码）都有一个确定的权。8421码是最常用的十进制有权码。也称自然BCD（NBCD）码。
2． 十进制无权码
每个十进制数位的4个基2码没有确定的权。在无权码方案中，用的较多的是余3码和格雷码。
3．其他编码方案  （5中取2码、独热码等）
符号位的表示：
 “+”：1100 ； “-”：1101
例：+236=(1100 0010 0011 0110)8421    (占2个字节)
    -2369=(1101 <mark>0000</mark> 0010 0011 0110 1001)8421    (占3个字节)
补零！！！

## 二、非数值数据、数据排列
### 1. 逻辑值
<p align="center">
<img src = "photos\2.2.1 逻辑值.png" width = 60% height = 100%>
</p>

### 2. 西文字符
<p align="center">
<img src = "photos\2.2.2 西文字符.png" width = 60% height = 100%>
</p>

### 3. 汉字
汉字是表意文字，一个字就是一个方块图形。
汉字数量巨大，总数超过6万字。

**有以下几种汉字代码：**
- 输入码：对汉字用相应按键进行编码表示，用于输入
- 内码：用于在系统中进行存储、查找、传送等处理
- 字模点阵或轮廓描述: 描述汉字字模点阵或轮廓，用于显示/打印

>Q：西文字符常用的内码是什么？
A: ASCII码！
对于汉字内码的选择，必须考虑以下几个因素：
① 不能有二义性，即不能和ASCII码有相同的编码。
② 尽量与汉字在字库中的位置有关，便于汉字查找和处理。
③ 编码应尽量短。
国标码（国标交换码）
      1981年我国颁布了《信息交换用汉字编码字符集·基本集》(GB2312—80)。该标准选出6763个常用汉字，为每个汉字规定了标准代码，以供汉字信息在不同计算机系统间交换使用
可在汉字国标码的基础上产生汉字机内码

**GB2312-80字符集**
**由三部分组成：**
① 字母、数字和各种符号，包括英文、俄文、日文平假名与片假名、罗马字母、汉语拼音等共687个
② 一级常用汉字，共3755个，按汉语拼音排列
③ 二级常用汉字，共3008个 ，不太常用，按偏旁部首排列
**汉字的区位码**
码表由94行、94列组成，行号为区号，列号为位号，各占7位
指出汉字在码表中的位置，共14位，区号在左、位号在右
**汉字的国标码**
每个汉字的区号和位号各自加上32（20H），得到其“国标码”
国标码中区号和位号各占7位。在计算机内部，为方便处理与存储，前面添一个0，构成一个字节

**汉字内码**（区位码→国标码→内码）
至少需2个字节才能表示一个汉字内码，这由由汉字的总数决定！
可在GB2312国标码的基础上产生汉字内码
为与ASCII码区别，将国标码的两个字节的第一位置“1”后得到一种汉字内码
   例如，汉字“大”在码表中位于第20行、第83列。因此区位码为0010100 1010011，国标码为00110100 01110011，即3473H。前面的34H和字符“4”的ACSII码相同，后面的73H和字符“s”的ACSII码相同，将每个字节的最高位各设为“1”后，就得到其内码：B4F3H (1011 0100 1111 0011B)，因而不会和ASCII码混淆。

**国际字符集**
>国际字符集的必要性
不同地区使用不同字符集内码，如中文GB2312 / Big5、日文Shift-JIS / EUC-JP等。在安装中文系统的计算机中打开日文文件，会出现乱码。
为使所有国际字符都能互换，必须创建一种涵盖全部字符的多字符集。
国际多字符集
通过对各种地区性字符集规定使用范围来唯一定义各字符的编码。
国际标准ISO/IEC 10646提出了一种包括全世界现代书面语言文字所使用的所有字符的标准编码，有4个字节编码(UCS-4)和2字节编码(UCS-2) 。
我国（包括香港、台湾地区）与日本、韩国联合制订了一个统一的汉字字符集（CJK编码），共收集了上述不同国家和地区共约2万多汉字及符号，采用2字节编码 (即：UCS-2) ，已被批准为国家标准(GB13000 )。
Windows操作系统(中文版)已采用中西文统一编码，收集了中、日、韩三国常用的约2万汉字，称为“Unicode”，采用2字节编码，与UCS-2一致 。  

**汉字的字模点阵码和轮廓描述**
为便于打印、显示汉字，汉字字形必须预先存在机内
- 字库 (font)：所有汉字形状的描述信息集合
- 不同字体 (如宋体、仿宋、楷体、黑体等) 对应不同字库
- 从字库中找到字形描述信息，然后送设备输出

问题：如何知道到哪里找相应的字形信息？
汉字内码与其在字库中的位置有关！！

字形主要有两种描述方法：
- 字模点阵描述（图像方式）
- 轮廓描述（图形方式）
  - 直线向量轮廓
  - 曲线轮廓（True Type字形）
  
### 4. 数据的基本宽度

比特（bit）是计算机中处理、存储、传输信息的最小单位
二进制信息的计量单位是“字节”(Byte)，也称“位组”
现代计算机中，存储器按字节编址
字节是最小可寻址单位 (addressable unit ) 
如果以字节为一个排列单位，则LSB表示最低有效字节，MSB表示最高有效字节


除比特和字节外，还经常使用“字”(word)作为单位
“字”和 “字长”的概念不同 
>“字长”指定点运算数据通路的宽度。
（数据通路指CPU内部数据流经的路径以及路径上的部件，主要是CPU内部进行数据运算、存储和传送的部件，这些部件的宽度基本上要一致，才能相互匹配。因此，”字长”等于CPU内部总线的宽度、运算器的位数、通用寄存器的宽度等。 ）
“字”表示被处理信息的单位，用来度量数据类型的宽度。
字和字长的宽度可以一样，也可不同。
  例如，x86体系结构定义“字”的宽度为16位，但从386开始字长就是32位了。

**数据度量单位**
存储二进制信息时的度量单位要比字节或字大得多
容量经常使用的单位有：
    “千字节”(KB)，1KB=2e10字节=1024B
    “兆字节”(MB)，1MB=2e20字节=1024KB
    “千兆字节”(GB)，1GB=2e30字节=1024MB
    “兆兆字节”(TB)，1TB=2e40字节=1024GB
  通信中的带宽使用的单位有：
    “千比特/秒”(kb/s)，1kbps=10e3 b/s=1000 bps
    “兆比特/秒”(Mb/s)，1Mbps=10e6 b/s =1000 kbps
    “千兆比特/秒”(Gb/s)，1Gbps=10e9 b/s =1000 Mbps
    “兆兆比特/秒”(Tb/s)，1Tbps=10e12 b/s =1000 Gbps

### 5. 数据的存储排列
<p align="center">
<img src = "photos\2.2.5 数据的存储方式.png" width = 60% height = 100%>
<img src = "photos\2.2.5 大小端存取方式.png" width = 60% height = 100%>
</p>

---

**字节交换**
<p align="center">
<img src = "photos\2.2.5 字节交换.png" width = 60% height = 100%>
</p>

**Alignment(对齐)**
<div style="display:flex; gap:em; justify-content:center;">
  <div style="text-align:center;">
    <img src="photos\2.2.5 对齐1.png" width="400"/>
  </div>
  <div style="text-align:center;">
    <img src="photos\2.2.5 对齐2.png" width="400"/>
  </div>
  <div style="text-align:center;">
    <img src="photos\2.2.5 对齐3.png" width="420"/>
  </div>
</div>

---
